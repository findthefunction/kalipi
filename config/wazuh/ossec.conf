<!--
  KaliPi â€” Wazuh/OSSEC agent config (local/standalone mode)
  No manager dependency. Monitors the Pi itself.
-->
<ossec_config>

  <client>
    <server>
      <address>127.0.0.1</address>
    </server>
  </client>

  <!-- File integrity monitoring -->
  <syscheck>
    <frequency>7200</frequency>
    <alert_new_files>yes</alert_new_files>

    <!-- Critical directories -->
    <directories check_all="yes" realtime="yes">/etc</directories>
    <directories check_all="yes" realtime="yes">/boot</directories>
    <directories check_all="yes" realtime="yes">/usr/bin</directories>
    <directories check_all="yes" realtime="yes">/usr/sbin</directories>
    <directories check_all="yes" realtime="yes">/sbin</directories>
    <directories check_all="yes" realtime="yes">/bin</directories>
    <directories check_all="yes">/home/kali/.ssh</directories>
    <directories check_all="yes">/var/lib/tailscale</directories>

    <!-- Ignore high-churn paths -->
    <ignore>/etc/mtab</ignore>
    <ignore>/etc/resolv.conf</ignore>
    <ignore>/etc/adjtime</ignore>
    <ignore>/var/log</ignore>
    <ignore>/var/run</ignore>
    <ignore>/var/lock</ignore>
  </syscheck>

  <!-- Rootkit detection -->
  <rootcheck>
    <frequency>14400</frequency>
    <rootkit_files>/var/ossec/etc/shared/rootkit_files.txt</rootkit_files>
    <rootkit_trojans>/var/ossec/etc/shared/rootkit_trojans.txt</rootkit_trojans>
    <system_audit>/var/ossec/etc/shared/system_audit_rcl.txt</system_audit>
  </rootcheck>

  <!-- Log monitoring -->
  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/auth.log</location>
  </localfile>

  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/syslog</location>
  </localfile>

  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/fail2ban.log</location>
  </localfile>

  <localfile>
    <log_format>json</log_format>
    <location>/var/log/suricata/eve.json</location>
  </localfile>

  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/kalipi-security.log</location>
  </localfile>

  <!-- Alerts -->
  <alerts>
    <log_alert_level>3</log_alert_level>
  </alerts>

  <logging>
    <log_all>no</log_all>
    <log_all_json>yes</log_all_json>
  </logging>

</ossec_config>
